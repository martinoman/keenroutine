(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{147:function(e,t,a){},150:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(77),s=a.n(c),i=(a(88),a(3)),o=a(4),u=a(6),l=a(5),p=a(7),m=a(14),d=a(9),h=a(156),f=a(152),v=a(155),b=a(12),g=a.n(b),E=(a(60),a(40),a(41),a(11)),O=a.n(E),j=a(19),y=(a(147),a(151)),k=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(u.a)(this,Object(l.a)(t).call(this,e))).state={message:"",signedUp:!1},a.handleSignUp=a.handleSignUp.bind(Object(m.a)(Object(m.a)(a))),a}return Object(p.a)(t,e),Object(o.a)(t,[{key:"handleSignUp",value:function(e){var t=this;e.preventDefault();var a=!1;e.target[1].value!==e.target[2].value?(this.setState({message:"Passwords do not match!"}),a=!0):g.a.auth().createUserWithEmailAndPassword(e.target[0].value,e.target[1].value).catch(function(e){t.setState({message:e.message}),a=!0}).then(function(){a||t.setState({signedUp:!0})})}},{key:"render",value:function(){return r.a.createElement("div",{className:"sign_up_page"},this.state.signedUp?r.a.createElement("div",{className:"sign_up_success"},r.a.createElement("div",{className:"sign_up_success_message"},"Account successfully created!"),r.a.createElement(y.a,{to:"/login"},r.a.createElement("button",null,"Go to login"))):r.a.createElement("div",{className:"sign_up_content"},r.a.createElement("form",{onSubmit:this.handleSignUp},r.a.createElement("p",null,"E-mail"),r.a.createElement("input",{type:"text",defaultValue:"a@a.com"}),r.a.createElement("p",null,"Password"),r.a.createElement("input",{type:"password",defaultValue:"asdasd"}),r.a.createElement("p",null,"Confirm password"),r.a.createElement("input",{type:"password",defaultValue:"asdasd"}),r.a.createElement("br",null),r.a.createElement("button",{type:"submit"},"Sign the f*** up")),r.a.createElement("div",{className:"sign_up_error_message"},this.state.message)))}}]),t}(n.Component),N=a(153),C=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(u.a)(this,Object(l.a)(t).call(this,e))).state={message:""},a.handleLogin=a.handleLogin.bind(Object(m.a)(Object(m.a)(a))),a}return Object(p.a)(t,e),Object(o.a)(t,[{key:"handleLogin",value:function(e){var t=this;e.preventDefault(),g.a.auth().signInWithEmailAndPassword(e.target[0].value,e.target[1].value).catch(function(e){console.log(e),t.setState({message:"Wrong password or email"})})}},{key:"render",value:function(){return r.a.createElement("div",{className:"login_page"},r.a.createElement("div",{className:"login-title"},"Login"),r.a.createElement("form",{onSubmit:this.handleLogin},r.a.createElement("input",{type:"text",defaultValue:"a@a.com"}),r.a.createElement("input",{type:"password",defaultValue:"asdasd"}),r.a.createElement("button",{type:"submit"},"Login")),r.a.createElement("div",{className:"login_status_message"},this.state.message),g.a.auth().currentUser?r.a.createElement(N.a,{to:{pathname:"/select_origin"}}):"")}}]),t}(n.Component),w=a(79),_=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(u.a)(this,Object(l.a)(t).call(this,e))).addPlace=function(e){e.preventDefault(),a.setState({inputAlias:!1});var t=e.target[0].value,n=Object(w.a)({},t,{ID:a.props.place.SiteId,X:a.props.place.X,Y:a.props.place.Y,Index:a.props.places.length});a.props.addPlace(n,a.props.user.userID)},a.state={inputAlias:!1},a}return Object(p.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){var e=this;return r.a.createElement("div",{className:"places-search-result-item"},r.a.createElement("div",{className:"places-search-result-item-name"},this.props.place.Name),r.a.createElement("div",{className:"places-search-result-item-button button",onClick:function(){e.setState({inputAlias:!0})}},"Add"),r.a.createElement("form",{className:"places-search-result-item-alias",onSubmit:this.addPlace},this.state.inputAlias?r.a.createElement("input",{className:"places-search-result-item-alias-field",type:"text",placeholder:"Alias"}):""))}}]),t}(n.Component),L=Object(d.b)(function(e){return{user:e.user,places:e.places}},{addPlace:function(e,t){return Object(j.a)(O.a.mark(function a(){return O.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:g.a.database().ref().child("users").child(t).push().set(e);case 2:case"end":return a.stop()}},a)}))}})(_),T=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(u.a)(this,Object(l.a)(t).call(this,e))).state={inputAlias:!1},a}return Object(p.a)(t,e),Object(o.a)(t,[{key:"renderList",value:function(){return r.a.createElement("div",{className:"places-search-result-list"},this.props.results.map(function(e,t){return r.a.createElement(L,{place:e,key:t})}))}},{key:"render",value:function(){return r.a.createElement("div",{className:"places-search-results"},this.renderList())}}]),t}(n.Component),A=Object(d.b)(function(e){return{}},function(e){return{}})(T),S=a(80),x=a.n(S),P=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(u.a)(this,Object(l.a)(t).call(this,e))).search=x.a.debounce(function(e){fetch("/searchStation?searchWord="+e,{}).then(function(e){return e.ok?e.json():null}).then(function(e){console.log(e),a.setState({searchResult:e.ResponseData})})},1e3),a.state={searchResult:[]},a}return Object(p.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){var e=this;return r.a.createElement("div",{className:"places-search"},r.a.createElement("div",{className:"search-bar"},r.a.createElement("input",{type:"text",placeholder:"Search for stations",onChange:function(t){var a=t.target.value;e.search(a)}})),r.a.createElement(A,{results:this.state.searchResult}))}}]),t}(n.Component),D=Object(d.b)(function(e){return{places:e.places}},function(e){return{}})(P),I=function(e){function t(){var e,a;Object(i.a)(this,t);for(var n=arguments.length,c=new Array(n),s=0;s<n;s++)c[s]=arguments[s];return(a=Object(u.a)(this,(e=Object(l.a)(t)).call.apply(e,[this].concat(c)))).removePlace=function(e){a.props.removePlace(e,a.props.user.userID)},a.renderPlacesList=function(){return r.a.createElement("div",{className:"manage_places_list"},null==a.props.user.userID?r.a.createElement("div",{className:"no-user-error"},"You must log in!"):a.props.places.map(function(e,t){return r.a.createElement("div",{className:"place-row",key:t},r.a.createElement("div",{className:"place-row-alias"},e.alias),r.a.createElement("div",{className:"place-row-adress"},e.adress),r.a.createElement("div",{onClick:function(){return a.removePlace(e.key)}},"x"))}))},a}return Object(p.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{className:"manage_places_page"},this.renderPlacesList(),r.a.createElement(D,null))}}]),t}(n.Component),U=Object(d.b)(function(e){return{user:e.user,places:e.places}},{removePlace:function(e,t){return function(){var a=Object(j.a)(O.a.mark(function a(n){return O.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:g.a.database().ref().child("users").child(t).child(e).remove(),n({type:"REMOVE_PLACE",key:e});case 3:case"end":return a.stop()}},a)}));return function(e){return a.apply(this,arguments)}}()}})(I),R=function(e){function t(){return Object(i.a)(this,t),Object(u.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){var e=this;return r.a.createElement("div",{className:"origin-selection-page"},r.a.createElement("div",{className:"origin-selection-header"},"Where are you?"),this.props.places.map(function(t,a){return r.a.createElement(y.a,{to:"/select_destination",key:a},r.a.createElement("div",{className:"select-origin-box",onClick:function(){e.props.changeLocation(t)}},t.alias))}))}}]),t}(n.Component),M=Object(d.b)(function(e){return{places:e.places,currentLocation:e.currentLocation}},{changeLocation:function(e){return function(){var t=Object(j.a)(O.a.mark(function t(a){return O.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",a({type:"CHANGE_LOCATION",location:e}));case 1:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()}})(R);function V(e,t){var a=e.Origin,n=e.Destination;return{leg:t,origin:{name:a.name,type:a.type},destination:{name:n.name,type:n.type}}}function W(e){return{type:e.type,distance:e.dist,departure:e.Origin.time,arrival:e.Destination.time,name:e.name,direction:e.direction}}var B=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(u.a)(this,Object(l.a)(t).call(this,e))).state={trips:[]},a}return Object(p.a)(t,e),Object(o.a)(t,[{key:"getTimes",value:function(){var e=this;console.log("5b562c873f1742f7b0224b73b2d33118");for(var t=this.props.places,a=this.props.currentLocation,n=[],r={},c=0;c<t.length;c++){var s=t[c];if(s!==a){var i=this.getParameters("5b562c873f1742f7b0224b73b2d33118",t[c],a);n.push(this.apiCall(i,r,s.alias))}}Promise.all(n).then(function(){e.setState(e.state)})}},{key:"getParameters",value:function(e,t,a){t=t.location,a=a.location;var n="key="+e,r={lang:"se",maxChange:3,limit:2,destExtId:t.id,destCoordLat:void 0===t.id?t.y:void 0,destCoordLong:void 0===t.id?t.x:void 0,originExtId:a.id,originCoordLat:void 0===a.id?a.y:void 0,originCoordLong:void 0===a.id?a.x:void 0};for(var c in r)r.hasOwnProperty(c)&&void 0!==r[c]&&(n+="&"+c+"="+r[c]);return n}},{key:"checkValid",value:function(e){return e.ok?e.json():null}},{key:"addTripToState",value:function(e,t){e=function(e){for(var t=e.Trip[0].LegList.Leg,a=[],n=0;n<t.length;n++){var r=V(t[n],n);r.travelMode=W(t[n]),a.push(r)}return a}(e);var a=this.parseTimeString(e[0].travelMode.departure),n=this.parseTimeString(e[e.length-1].travelMode.arrival),r=(n-a)/6e4,c=(a-Date.now())/6e4,s={to:t,from:this.props.currentLocation.alias,departureTime:a,arrivalTime:n,travelTime:r,timeUntilDeparture:c,trip:e};this.state.trips.push(s)}},{key:"parseTimeString",value:function(e){var t=new Date(Date.now()),a=e.split(":");return t.setHours(a[0]),t.setMinutes(a[1]),t.setSeconds(a[2]),t}},{key:"apiCall",value:function(e,t,a){var n=this;return fetch("/selectDestinationTime?"+e,t).then(function(e){return n.checkValid(e)}).then(function(e){n.addTripToState(e,a)}).catch(function(e){console.log("SOMETHING WENT WRONG:"),console.log(e)})}},{key:"componentDidMount",value:function(){this.getTimes()}},{key:"render",value:function(){var e=this;return r.a.createElement("div",{className:"destination-selection-page"},this.state.trips.map(function(t,a){return r.a.createElement(y.a,{to:"/travel_guide",key:a},r.a.createElement("div",{className:"trip-summary",onClick:function(){e.props.focusTrip(t)}},r.a.createElement("div",{className:"trip-summary-alias"},"To: ",t.to),r.a.createElement("div",{className:"trip-summary-time-until-departure"},t.timeUntilDeparture,"min until departure"),r.a.createElement("div",{className:"trip-summary-travel-time"},t.travelTime,"min total travel time")))}))}}]),t}(n.Component),G=Object(d.b)(function(e){return{places:e.places,currentLocation:e.currentLocation}},{focusTrip:function(e){return function(){var t=Object(j.a)(O.a.mark(function t(a){return O.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",a({type:"FOCUS_TRIP",trip:e}));case 1:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()}})(B),Y=function(e){function t(){return Object(i.a)(this,t),Object(u.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{className:"travel-guide-page"},"Trip to ",this.props.focusedTrip.to,this.props.focusedTrip.trip.map(function(e,t){return r.a.createElement("div",{className:"focused-trip-leg",key:t},r.a.createElement("div",{className:"focused-trip-leg-from"},"from ",e.origin.name," at ",e.travelMode.departure),r.a.createElement("div",{className:"focused-trip-leg-conveyance"},"WALK"===e.travelMode.type?"Walk":"Take "+e.travelMode.name+" towards "+e.travelMode.direction),r.a.createElement("div",{className:"focused-trip-leg-to"},"arrive at ",e.destination.name," at ",e.travelMode.arrival))}))}}]),t}(n.Component),H=Object(d.b)(function(e){return{focusedTrip:e.focusedTrip}},function(e){return{}})(Y),J=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(u.a)(this,Object(l.a)(t).call(this,e))).toggleNavbar=function(){var e=!a.state.expanded;a.setState({expanded:e})},a.state={expanded:!0},a}return Object(p.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{className:""},this.state.expanded?r.a.createElement("div",{className:""},r.a.createElement("button",{onClick:this.toggleNavbar},"V")):r.a.createElement("div",{className:"",onClick:this.toggleNavbar},r.a.createElement(y.a,{to:"/login"},"Login "),r.a.createElement("br",null),r.a.createElement(y.a,{to:"/manage_places"},"Manage your places "),r.a.createElement("br",null),r.a.createElement(y.a,{to:"/select_origin"},"New trip "),r.a.createElement("br",null),r.a.createElement("div",{onClick:this.props.logout},"logout"),r.a.createElement("button",{onClick:this.toggleNavbar},"\u039b")))}}]),t}(n.Component),K=Object(v.a)(Object(d.b)(function(e){return{}},{logout:function(){return Object(j.a)(O.a.mark(function e(){return O.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:g.a.auth().signOut().catch(function(e){console.log("signOut falied:"),console.log(e)});case 1:case"end":return e.stop()}},e)}))}})(J)),X=function(e){function t(){return Object(i.a)(this,t),Object(u.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{className:"private-route"},g.a.auth().currentUser?r.a.createElement(f.a,{path:this.props.path,render:this.props.render}):r.a.createElement(N.a,{to:{pathname:"/login"}}))}}]),t}(n.Component),z=function(e){function t(){var e;return Object(i.a)(this,t),(e=Object(u.a)(this,Object(l.a)(t).call(this))).authChange=e.authChange.bind(Object(m.a)(Object(m.a)(e))),g.a.auth().onAuthStateChanged(e.authChange),e}return Object(p.a)(t,e),Object(o.a)(t,[{key:"authChange",value:function(e){e&&(this.props.loadUser(e),this.props.subscribeToDB(this.props.user.userID)),null===e&&(this.props.clearState(),localStorage.clear())}},{key:"render",value:function(){return console.log(Object({NODE_ENV:"production",PUBLIC_URL:"",REACT_APP_ReseplanerareAPI:"5b562c873f1742f7b0224b73b2d33118",REACT_APP_PlatsuppslagAPI:"8376d23038b74e9a98544c1795a6613c"}).REACT_APP_SL),r.a.createElement("div",{className:"App"},r.a.createElement(K,null),r.a.createElement(h.a,null,r.a.createElement(f.a,{exact:!0,path:"/signup",render:function(e){return r.a.createElement(k,e)}}),r.a.createElement(f.a,{exact:!0,path:"/login",render:function(e){return r.a.createElement(C,e)}}),r.a.createElement(X,{exact:!0,path:"/manage_places",render:function(e){return r.a.createElement(U,e)}}),r.a.createElement(X,{exact:!0,path:"/select_origin",render:function(e){return r.a.createElement(M,e)}}),r.a.createElement(X,{exact:!0,path:"/select_destination",render:function(e){return r.a.createElement(G,e)}}),r.a.createElement(X,{exact:!0,path:"/travel_guide",render:function(e){return r.a.createElement(H,e)}}),r.a.createElement(X,{exact:!0,path:"/",render:function(e){return r.a.createElement(C,e)}})))}}]),t}(n.Component),F=Object(v.a)(Object(d.b)(function(e){return{user:e.user,places:e.places}},{loadUser:function(e){return function(){var t=Object(j.a)(O.a.mark(function t(a){return O.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",a({type:"LOAD_USER",user:e}));case 1:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()},subscribeToDB:function(e){return function(){var t=Object(j.a)(O.a.mark(function t(a){return O.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:g.a.database().ref().child("users").child(e).on("child_added",function(e){var t=e.val(),n=e.key;a({type:"ADD_PLACE",place:t,key:n})});case 2:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()},clearState:function(){return function(){var e=Object(j.a)(O.a.mark(function e(t){return O.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",t({type:"CLEAR_STATE"}));case 1:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()}})(z));Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var Z=a(34),$=a(82),q=a(64),Q={user:{userName:null,userID:null},places:[],currentLocation:"",focusedTrip:"",loggedIn:!1},ee=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Q,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"ADD_PLACE":var a=Object(q.a)(e.places);return Object.entries(t.place).forEach(function(e){a.push({alias:e[0],location:{id:e[1].ID,x:e[1].X,y:e[1].Y},index:e.index,key:t.key})}),Object.assign({},e,{places:a});case"REMOVE_PLACE":for(var n=Object(q.a)(e.places),r=0;r<n.length;r++)n[r].key===t.key&&n.splice(r,1);return Object.assign({},e,{places:n});case"LOAD_USER":return Object.assign({},e,{user:{userName:t.user.email,userID:t.user.uid}});case"CHANGE_LOCATION":return Object.assign({},e,{currentLocation:t.location});case"FOCUS_TRIP":return Object.assign({},e,{focusedTrip:t.trip});case"CLEAR_STATE":return Q;default:return e}},te={apiKey:"AIzaSyB9OKDYZOcUAJUyf2x4xiEU0SLwV3vCPBI",authDomain:"keenroutine-f5ccb.firebaseapp.com",databaseURL:"https://keenroutine-f5ccb.firebaseio.com",projectId:"keenroutine-f5ccb",storageBucket:"keenroutine-f5ccb.appspot.com",messagingSenderId:"284130944841"},ae=a(154),ne=Object(Z.c)(ee,{user:{userName:null,userID:null},places:[],currentLocation:"",focusedTrip:"",loggedIn:!1},Object(Z.a)($.a));g.a.initializeApp(te),s.a.render(r.a.createElement(d.a,{store:ne},r.a.createElement(ae.a,null,r.a.createElement(F,null))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})},83:function(e,t,a){e.exports=a(150)},88:function(e,t,a){}},[[83,1,2]]]);
//# sourceMappingURL=main.1441147c.chunk.js.map